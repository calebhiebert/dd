<div class="card p-2">
  <div class="columns">
    <div *ngIf="showMoveIcon" cdkDragHandle>
      <i class="icon icon-resize-vert c-move"></i>
    </div>

    <!-- Image -->
    <div class="column col-auto" *ngIf="entity.imageId">
      <figure class="avatar hide-sm" [ngClass]="{ badge: label }" [attr.data-badge]="label">
        <img src="https://res.cloudinary.com/dqhk8k6iv/image/upload/t_thumb/{{ entity.imageId }}" />
      </figure>
      <figure class="avatar avatar-sm show-sm" [ngClass]="{ badge: label }" [attr.data-badge]="label">
        <img src="https://res.cloudinary.com/dqhk8k6iv/image/upload/t_thumb/{{ entity.imageId }}" />
      </figure>
    </div>

    <!-- Misc -->
    <div class="column">
      <div class="columns">
        <div class="column col-2 col-md-3 col-sm-12">
          <h6 class="fake-link d-inline" [routerLink]="['/campaigns', entity.campaignId, 'entities', entity.id]">{{ entity.name }}</h6>

          <!-- Concepts -->
          <div class="d-inline-block mb-2">
            <figure
              class="avatar avatar-sm tooltip c-hand ml-2"
              [attr.data-tooltip]="concept.name"
              *ngFor="let concept of concepts; trackBy: trackConcept"
              [routerLink]="['/campaigns', entity.campaignId, 'concepts', concept.conceptTypeId, concept.id, 'view']"
            >
              <img src="https://res.cloudinary.com/dqhk8k6iv/image/upload/t_thumb/{{ concept.imageId }}" alt="" />
            </figure>
          </div>
        </div>
        <div class="column col-10 col-md-9 col-sm-12">
          <dd-health-display
            [health]="entity.health"
            [editable]="editable"
            [mini]="true"
            [preset]="preset.health"
            (healthChange)="onHealthChange($event)"
            *ngIf="entity.health"
          ></dd-health-display>
        </div>
      </div>
    </div>

    <!-- Controls -->
    <div class="column col-auto d-flex align-items-center">
      <div class="dropdown dropdown-right">
        <button class="btn btn-sm dropdown-toggle" tabindex="0">
          <i class="icon icon-menu"></i>
        </button>
        <ul class="menu p-1 pt-2">
          <li class="menu-item">
            <section class="tile tile-centered">
              <div class="tile-icon">
                <img src="https://res.cloudinary.com/dqhk8k6iv/image/upload/t_thumb/{{ entity.imageId }}" alt="avatar" class="avatar" />
              </div>
              <div class="tile-content">
                {{ entity.name }}
              </div>
            </section>
          </li>

          <li class="divider"></li>

          <!-- View Action -->
          <li class="menu-item" [routerLink]="['/campaigns', entity.campaignId, 'entities', entity.id]">
            <div><i class="icon icon-arrow-right"></i> View</div>
          </li>

          <!-- Label Action -->
          <li class="menu-item" (click)="editLabel.emit(true)" *ngIf="editable">
            <div><i class="icon icon-edit"></i> Label</div>
          </li>

          <li class="menu-item" (click)="editConceptRelations(ct)" *ngFor="let ct of conceptTypes">
            <div><i class="icon icon-plus"></i> Add {{ ct.name }}</div>
          </li>

          <!-- Kill Action -->
          <li class="menu-item" (click)="kill()" *ngIf="editable">
            <div><i class="icon icon-cross"></i> Kill</div>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>
