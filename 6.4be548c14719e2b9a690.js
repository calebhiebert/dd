(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{jK0F:function(l,n,e){"use strict";e.r(n);var t=e("CcnG"),u=function(){return function(){}}(),i=e("pMnS"),r=e("9Bt9"),o=e("Ip0R"),a=e("qAlS"),c=e("Fzqc"),s=e("ZYCi"),b=e("7IS7"),p=e("qcJQ"),d=e("uCWu"),v=e("AxCL"),h=e("edGd"),f=e("AytR"),g=e("t/Na"),y=function(){function l(l){this.http=l}return l.prototype.getOverviewState=function(l){return this.http.get(f.a.apiURL+"/overviewstates/"+l).toPromise()},l.prototype.updateOverviewState=function(l,n){return this.http.put(f.a.apiURL+"/overviewstates/campaign/"+n,l).toPromise()},l.ngInjectableDef=t.T({factory:function(){return new l(t.X(g.c))},token:l,providedIn:"root"}),l}(),m=e("dtdw"),w=e("/fvA"),k=function(l,n,e,t){return new(e||(e=Promise))(function(u,i){function r(l){try{a(t.next(l))}catch(n){i(n)}}function o(l){try{a(t.throw(l))}catch(n){i(n)}}function a(l){l.done?u(l.value):new e(function(n){n(l.value)}).then(r,o)}a((t=t.apply(l,n||[])).next())})},S=function(l,n){var e,t,u,i,r={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(i){return function(o){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;r;)try{if(e=1,t&&(u=2&i[0]?t.return:i[0]?t.throw||((u=t.return)&&u.call(t),0):t.next)&&!(u=u.call(t,i[1])).done)return u;switch(t=0,u&&(i=[2&i[0],u.value]),i[0]){case 0:case 1:u=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,t=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(u=(u=r.trys).length>0&&u[u.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!u||i[1]>u[0]&&i[1]<u[3])){r.label=i[1];break}if(6===i[0]&&r.label<u[1]){r.label=u[1],u=i;break}if(u&&r.label<u[2]){r.label=u[2],r.ops.push(i);break}u[2]&&r.ops.pop(),r.trys.pop();continue}i=n.call(l,r)}catch(o){i=[6,o],t=0}finally{e=u=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}},C=function(){function l(l,n,e,t){var u=this;this.campaignService=l,this.stateService=n,this.updateService=e,this.conceptService=t,this._viewMode="full",this._reorderable=!1,this._loading=!1,e.overviewStateUpdate.subscribe(function(l){u._overviewState=l})}return l.prototype.getSortOrder=function(l){var n={};return l.forEach(function(l,e){n[l.id]=e}),n},l.prototype.updateState=function(){return k(this,void 0,void 0,function(){return S(this,function(l){this._loading=!0;try{this.stateService.updateOverviewState(this._overviewState,this.campaignService.campaign.id)}catch(n){throw n}return this._loading=!1,[2]})})},l.prototype.getConceptsForEntities=function(){return k(this,void 0,void 0,function(){var l,n,e,t,u,i,r,o,a,c,s,b,p,d,v=this;return S(this,function(h){switch(h.label){case 0:if(!this._overviewState)return[2];for(n={},e=0,t=Object.entries(this._overviewState.entityConcepts);e<t.length;e++)for((u=t[e])[0],i=u[1],r=0,o=Object.entries(i);r<o.length;r++)a=o[r],c=a[0],s=a[1],n[c]||(n[c]=[]),(l=n[c]).push.apply(l,s);return b=Object.entries(n).map(function(l){var n=l[0],e=l[1];return v.conceptService.getConcepts(n,50,0,null,null,e)}),[4,Promise.all(b)];case 1:return p=h.sent(),d={},p.forEach(function(l){l.concepts.forEach(function(l){d[l.id]=l})}),this._concepts=d,[2]}})})},l.prototype.loadOverviewState=function(){return k(this,void 0,void 0,function(){var l,n;return S(this,function(e){switch(e.label){case 0:if(this.campaignService.campaign.overviewStateId||!this.campaignService.canEdit)return[3,5];this._loading=!0,e.label=1;case 1:return e.trys.push([1,3,,4]),l=this,[4,this.stateService.updateOverviewState({entitySortOrder:{},entityLabels:{},entityConcepts:{}},this.campaignService.campaign.id)];case 2:return l._overviewState=e.sent(),[3,4];case 3:throw e.sent();case 4:return this._loading=!1,[2];case 5:this._loading=!0,e.label=6;case 6:return e.trys.push([6,8,,9]),n=this,[4,this.stateService.getOverviewState(this.campaignService.campaign.overviewStateId)];case 7:return n._overviewState=e.sent(),this.getConceptsForEntities(),[3,9];case 8:throw e.sent();case 9:return this._loading=!1,[2]}})})},l.prototype.setViewMode=function(l){this._viewMode=l},l.prototype.toggleReorderable=function(){this._reorderable=!this._reorderable},l.prototype.swapEntities=function(l,n){var e=this.sortedEntities.slice();Object(r.k)(e,l,n),this._overviewState&&(this._overviewState.entitySortOrder=this.getSortOrder(e),this.updateState())},l.prototype.setLabel=function(l,n){return k(this,void 0,void 0,function(){return S(this,function(e){switch(e.label){case 0:return this._overviewState?(this._overviewState.entityLabels[l.id]=n,[4,this.updateState()]):[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},l.prototype.addConceptEntity=function(l,n,e){return k(this,void 0,void 0,function(){return S(this,function(t){switch(t.label){case 0:return this._overviewState?(this._overviewState.entityConcepts[l.id]||(this._overviewState.entityConcepts[l.id]={}),this._overviewState.entityConcepts[l.id][e.id]||(this._overviewState.entityConcepts[l.id][e.id]=[]),-1===this._overviewState.entityConcepts[l.id][e.id].indexOf(n.id)&&this._overviewState.entityConcepts[l.id][e.id].push(n.id),this.getConceptsForEntities(),[4,this.updateState()]):[2];case 1:return t.sent(),[2]}})})},Object.defineProperty(l.prototype,"entities",{get:function(){return this.campaignService.campaign.entities.filter(function(l){return!l.spawnable})},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"sortedEntities",{get:function(){var l=this;return this._overviewState?this.entities.slice().sort(function(n,e){return(l._overviewState.entitySortOrder[n.id]||0)-(l._overviewState.entitySortOrder[e.id]||0)}):this.entities},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"reorderable",{get:function(){return this._reorderable},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"state",{get:function(){return this._overviewState},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"viewMode",{get:function(){return this._viewMode},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"concepts",{get:function(){return this._concepts||{}},enumerable:!0,configurable:!0}),l.ngInjectableDef=t.T({factory:function(){return new l(t.X(d.b),t.X(y),t.X(m.b),t.X(w.a))},token:l,providedIn:"root"}),l}(),q=e("PSD3"),I=e.n(q),_=function(){return(_=Object.assign||function(l){for(var n,e=1,t=arguments.length;e<t;e++)for(var u in n=arguments[e])Object.prototype.hasOwnProperty.call(n,u)&&(l[u]=n[u]);return l}).apply(this,arguments)},E=function(l,n,e,t){return new(e||(e=Promise))(function(u,i){function r(l){try{a(t.next(l))}catch(n){i(n)}}function o(l){try{a(t.throw(l))}catch(n){i(n)}}function a(l){l.done?u(l.value):new e(function(n){n(l.value)}).then(r,o)}a((t=t.apply(l,n||[])).next())})},O=function(l,n){var e,t,u,i,r={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(i){return function(o){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;r;)try{if(e=1,t&&(u=2&i[0]?t.return:i[0]?t.throw||((u=t.return)&&u.call(t),0):t.next)&&!(u=u.call(t,i[1])).done)return u;switch(t=0,u&&(i=[2&i[0],u.value]),i[0]){case 0:case 1:u=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,t=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(u=(u=r.trys).length>0&&u[u.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!u||i[1]>u[0]&&i[1]<u[3])){r.label=i[1];break}if(6===i[0]&&r.label<u[1]){r.label=u[1],u=i;break}if(u&&r.label<u[2]){r.label=u[2],r.ops.push(i);break}u[2]&&r.ops.pop(),r.trys.pop();continue}i=n.call(l,r)}catch(o){i=[6,o],t=0}finally{e=u=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}},P=function(){function l(l,n,e,u){this.campaignService=l,this.loginService=n,this.entityService=e,this.overviewService=u,this.saving=!1,this.editLabel=new t.m,this.addConcept=new t.m}return l.prototype.ngOnInit=function(){},l.prototype.updateEntity=function(l){return E(this,void 0,void 0,function(){return O(this,function(n){switch(n.label){case 0:this.saving=!0,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.entityService.updateEntity(l)];case 2:return n.sent(),[3,4];case 3:throw n.sent();case 4:return this.saving=!1,[2]}})})},l.prototype.onHealthChange=function(l){this.updateEntity(_({},this.entity,{health:l}))},l.prototype.kill=function(){return E(this,void 0,void 0,function(){return O(this,function(l){switch(l.label){case 0:return[4,I.a.fire({titleText:"Are you sure?",text:"You will not be able to undo this"})];case 1:return!0!==l.sent().value?[3,3]:[4,this.entityService.deleteEntity(this.entity.id)];case 2:l.sent(),l.label=3;case 3:return[2]}})})},l.prototype.editConceptRelations=function(l){this.addConcept.emit(l)},l.prototype.trackConcept=function(l,n){return n.id},Object.defineProperty(l.prototype,"preset",{get:function(){var l=this;return this.campaignService.campaign.entityPresets.find(function(n){return n.id===l.entity.entityPresetId})},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"editable",{get:function(){return(this.campaignService.canEdit||this.entity.userId===this.loginService.id)&&"full"===this.overviewService.viewMode},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"conceptTypes",{get:function(){return this.campaignService.campaign.conceptTypes.filter(function(l){return!0===l.isUsableInOverviewScreen})},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"concepts",{get:function(){var l=this;if(!this.conceptEntities||!this.overviewService.concepts)return[];for(var n=[],e=0,t=Object.entries(this.conceptEntities);e<t.length;e++){var u=t[e];u[0],u[1].forEach(function(e){var t=l.overviewService.concepts[e];t&&n.push(t)})}return console.log(n),n},enumerable:!0,configurable:!0}),l}(),A=t.ob({encapsulation:0,styles:[[""]],data:{}});function x(l){return t.Kb(0,[(l()(),t.qb(0,0,null,null,2,"div",[["cdkDragHandle",""],["class","cdk-drag-handle"]],null,null,null,null,null)),t.pb(1,147456,null,0,r.d,[t.k,[2,r.l]],null,null),(l()(),t.qb(2,0,null,null,0,"i",[["class","icon icon-resize-vert c-move"]],null,null,null,null,null))],null,null)}function j(l){return t.Kb(0,[(l()(),t.qb(0,0,null,null,8,"div",[["class","column col-auto"]],null,null,null,null,null)),(l()(),t.qb(1,0,null,null,3,"figure",[["class","avatar hide-sm"]],[[1,"data-badge",0]],null,null,null,null)),t.pb(2,278528,null,0,o.i,[t.t,t.u,t.k,t.E],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),t.Db(3,{badge:0}),(l()(),t.qb(4,0,null,null,0,"img",[],[[8,"src",4]],null,null,null,null)),(l()(),t.qb(5,0,null,null,3,"figure",[["class","avatar avatar-sm show-sm"]],[[1,"data-badge",0]],null,null,null,null)),t.pb(6,278528,null,0,o.i,[t.t,t.u,t.k,t.E],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),t.Db(7,{badge:0}),(l()(),t.qb(8,0,null,null,0,"img",[],[[8,"src",4]],null,null,null,null))],function(l,n){var e=n.component,t=l(n,3,0,e.label);l(n,2,0,"avatar hide-sm",t);var u=l(n,7,0,e.label);l(n,6,0,"avatar avatar-sm show-sm",u)},function(l,n){var e=n.component;l(n,1,0,e.label),l(n,4,0,t.sb(1,"https://res.cloudinary.com/dqhk8k6iv/image/upload/t_thumb/",e.entity.imageId,"")),l(n,5,0,e.label),l(n,8,0,t.sb(1,"https://res.cloudinary.com/dqhk8k6iv/image/upload/t_thumb/",e.entity.imageId,""))})}function L(l){return t.Kb(0,[(l()(),t.qb(0,0,null,null,3,"figure",[["class","avatar avatar-sm tooltip c-hand ml-2"]],[[1,"data-tooltip",0]],[[null,"click"]],function(l,n,e){var u=!0;return"click"===n&&(u=!1!==t.Ab(l,1).onClick()&&u),u},null,null)),t.pb(1,16384,null,0,s.m,[s.l,s.a,[8,null],t.E,t.k],{routerLink:[0,"routerLink"]},null),t.Bb(2,6),(l()(),t.qb(3,0,null,null,0,"img",[["alt",""]],[[8,"src",4]],null,null,null,null))],function(l,n){var e=l(n,2,0,"/campaigns",n.component.entity.campaignId,"concepts",n.context.$implicit.conceptTypeId,n.context.$implicit.id,"view");l(n,1,0,e)},function(l,n){l(n,0,0,n.context.$implicit.name),l(n,3,0,t.sb(1,"https://res.cloudinary.com/dqhk8k6iv/image/upload/t_thumb/",n.context.$implicit.imageId,""))})}function M(l){return t.Kb(0,[(l()(),t.qb(0,0,null,null,1,"dd-health-display",[],null,[[null,"healthChange"]],function(l,n,e){var t=!0,u=l.component;return"healthChange"===n&&(t=!1!==u.onHealthChange(e)&&t),t},b.b,b.a)),t.pb(1,114688,null,0,p.a,[d.b],{editable:[0,"editable"],health:[1,"health"],preset:[2,"preset"],mini:[3,"mini"]},{healthChange:"healthChange"})],function(l,n){var e=n.component;l(n,1,0,e.editable,e.entity.health,e.preset.health,!0)},null)}function T(l){return t.Kb(0,[(l()(),t.qb(0,0,null,null,3,"li",[["class","menu-item"]],null,[[null,"click"]],function(l,n,e){var t=!0,u=l.component;return"click"===n&&(t=!1!==u.editLabel.emit(!0)&&t),t},null,null)),(l()(),t.qb(1,0,null,null,2,"div",[],null,null,null,null,null)),(l()(),t.qb(2,0,null,null,0,"i",[["class","icon icon-edit"]],null,null,null,null,null)),(l()(),t.Ib(-1,null,[" Label"]))],null,null)}function F(l){return t.Kb(0,[(l()(),t.qb(0,0,null,null,3,"li",[["class","menu-item"]],null,[[null,"click"]],function(l,n,e){var t=!0,u=l.component;return"click"===n&&(t=!1!==u.editConceptRelations(l.context.$implicit)&&t),t},null,null)),(l()(),t.qb(1,0,null,null,2,"div",[],null,null,null,null,null)),(l()(),t.qb(2,0,null,null,0,"i",[["class","icon icon-plus"]],null,null,null,null,null)),(l()(),t.Ib(3,null,[" Add ",""]))],null,function(l,n){l(n,3,0,n.context.$implicit.name)})}function D(l){return t.Kb(0,[(l()(),t.qb(0,0,null,null,3,"li",[["class","menu-item"]],null,[[null,"click"]],function(l,n,e){var t=!0,u=l.component;return"click"===n&&(t=!1!==u.kill()&&t),t},null,null)),(l()(),t.qb(1,0,null,null,2,"div",[],null,null,null,null,null)),(l()(),t.qb(2,0,null,null,0,"i",[["class","icon icon-cross"]],null,null,null,null,null)),(l()(),t.Ib(-1,null,[" Kill"]))],null,null)}function K(l){return t.Kb(0,[(l()(),t.qb(0,0,null,null,42,"div",[["class","card p-2"]],null,null,null,null,null)),(l()(),t.qb(1,0,null,null,41,"div",[["class","columns"]],null,null,null,null,null)),(l()(),t.hb(16777216,null,null,1,null,x)),t.pb(3,16384,null,0,o.k,[t.P,t.M],{ngIf:[0,"ngIf"]},null),(l()(),t.hb(16777216,null,null,1,null,j)),t.pb(5,16384,null,0,o.k,[t.P,t.M],{ngIf:[0,"ngIf"]},null),(l()(),t.qb(6,0,null,null,12,"div",[["class","column"]],null,null,null,null,null)),(l()(),t.qb(7,0,null,null,11,"div",[["class","columns"]],null,null,null,null,null)),(l()(),t.qb(8,0,null,null,7,"div",[["class","column col-2 col-md-3 col-sm-12"]],null,null,null,null,null)),(l()(),t.qb(9,0,null,null,3,"h6",[["class","fake-link d-inline"]],null,[[null,"click"]],function(l,n,e){var u=!0;return"click"===n&&(u=!1!==t.Ab(l,10).onClick()&&u),u},null,null)),t.pb(10,16384,null,0,s.m,[s.l,s.a,[8,null],t.E,t.k],{routerLink:[0,"routerLink"]},null),t.Bb(11,4),(l()(),t.Ib(12,null,["",""])),(l()(),t.qb(13,0,null,null,2,"div",[["class","d-inline-block mb-2"]],null,null,null,null,null)),(l()(),t.hb(16777216,null,null,1,null,L)),t.pb(15,278528,null,0,o.j,[t.P,t.M,t.t],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null),(l()(),t.qb(16,0,null,null,2,"div",[["class","column col-10 col-md-9 col-sm-12"]],null,null,null,null,null)),(l()(),t.hb(16777216,null,null,1,null,M)),t.pb(18,16384,null,0,o.k,[t.P,t.M],{ngIf:[0,"ngIf"]},null),(l()(),t.qb(19,0,null,null,23,"div",[["class","column col-auto d-flex align-items-center"]],null,null,null,null,null)),(l()(),t.qb(20,0,null,null,22,"div",[["class","dropdown dropdown-right"]],null,null,null,null,null)),(l()(),t.qb(21,0,null,null,1,"button",[["class","btn btn-sm dropdown-toggle"],["tabindex","0"]],null,null,null,null,null)),(l()(),t.qb(22,0,null,null,0,"i",[["class","icon icon-menu"]],null,null,null,null,null)),(l()(),t.qb(23,0,null,null,19,"ul",[["class","menu p-1 pt-2"]],null,null,null,null,null)),(l()(),t.qb(24,0,null,null,5,"li",[["class","menu-item"]],null,null,null,null,null)),(l()(),t.qb(25,0,null,null,4,"section",[["class","tile tile-centered"]],null,null,null,null,null)),(l()(),t.qb(26,0,null,null,1,"div",[["class","tile-icon"]],null,null,null,null,null)),(l()(),t.qb(27,0,null,null,0,"img",[["alt","avatar"],["class","avatar"]],[[8,"src",4]],null,null,null,null)),(l()(),t.qb(28,0,null,null,1,"div",[["class","tile-content"]],null,null,null,null,null)),(l()(),t.Ib(29,null,[" "," "])),(l()(),t.qb(30,0,null,null,0,"li",[["class","divider"]],null,null,null,null,null)),(l()(),t.qb(31,0,null,null,5,"li",[["class","menu-item"]],null,[[null,"click"]],function(l,n,e){var u=!0;return"click"===n&&(u=!1!==t.Ab(l,32).onClick()&&u),u},null,null)),t.pb(32,16384,null,0,s.m,[s.l,s.a,[8,null],t.E,t.k],{routerLink:[0,"routerLink"]},null),t.Bb(33,4),(l()(),t.qb(34,0,null,null,2,"div",[],null,null,null,null,null)),(l()(),t.qb(35,0,null,null,0,"i",[["class","icon icon-arrow-right"]],null,null,null,null,null)),(l()(),t.Ib(-1,null,[" View"])),(l()(),t.hb(16777216,null,null,1,null,T)),t.pb(38,16384,null,0,o.k,[t.P,t.M],{ngIf:[0,"ngIf"]},null),(l()(),t.hb(16777216,null,null,1,null,F)),t.pb(40,278528,null,0,o.j,[t.P,t.M,t.t],{ngForOf:[0,"ngForOf"]},null),(l()(),t.hb(16777216,null,null,1,null,D)),t.pb(42,16384,null,0,o.k,[t.P,t.M],{ngIf:[0,"ngIf"]},null)],function(l,n){var e=n.component;l(n,3,0,e.showMoveIcon),l(n,5,0,e.entity.imageId);var t=l(n,11,0,"/campaigns",e.entity.campaignId,"entities",e.entity.id);l(n,10,0,t),l(n,15,0,e.concepts,e.trackConcept),l(n,18,0,e.entity.health);var u=l(n,33,0,"/campaigns",e.entity.campaignId,"entities",e.entity.id);l(n,32,0,u),l(n,38,0,e.editable),l(n,40,0,e.conceptTypes),l(n,42,0,e.editable)},function(l,n){var e=n.component;l(n,12,0,e.entity.name),l(n,27,0,t.sb(1,"https://res.cloudinary.com/dqhk8k6iv/image/upload/t_thumb/",e.entity.imageId,"")),l(n,29,0,e.entity.name)})}var R=e("gIcY"),G=function(){function l(l){this.overviewService=l}return l.prototype.ngOnInit=function(){var l=this;this.sortGroup=new R.k({mode:new R.h(0),direction:new R.h(0)}),this.viewModeControl=new R.h(this.overviewService.viewMode),this.viewModeControl.valueChanges.subscribe(function(n){l.overviewService.setViewMode(n)})},l.prototype.toggleReorderable=function(){this.overviewService.toggleReorderable()},Object.defineProperty(l.prototype,"reorderable",{get:function(){return this.overviewService.reorderable},enumerable:!0,configurable:!0}),l}(),$=t.ob({encapsulation:0,styles:[[""]],data:{}});function B(l){return t.Kb(0,[(l()(),t.qb(0,0,null,null,23,"div",[["class","columns"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"submit"],[null,"reset"]],function(l,n,e){var u=!0;return"submit"===n&&(u=!1!==t.Ab(l,1).onSubmit(e)&&u),"reset"===n&&(u=!1!==t.Ab(l,1).onReset()&&u),u},null,null)),t.pb(1,540672,null,0,R.l,[[8,null],[8,null]],{form:[0,"form"]},null),t.Fb(2048,null,R.c,null,[R.l]),t.pb(3,16384,null,0,R.r,[[4,R.c]],null,null),(l()(),t.qb(4,0,null,null,4,"div",[["class","column col-auto"]],null,null,null,null,null)),(l()(),t.qb(5,0,null,null,3,"button",[["class","btn"]],null,[[null,"click"]],function(l,n,e){var t=!0,u=l.component;return"click"===n&&(t=!1!==u.toggleReorderable()&&t),t},null,null)),t.pb(6,278528,null,0,o.i,[t.t,t.u,t.k,t.E],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),t.Db(7,{"btn-primary":0}),(l()(),t.qb(8,0,null,null,0,"i",[["class","icon icon-resize-vert"]],null,null,null,null,null)),(l()(),t.qb(9,0,null,null,14,"div",[["class","column"]],null,null,null,null,null)),(l()(),t.qb(10,0,null,null,13,"select",[["class","form-input"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"change"],[null,"blur"]],function(l,n,e){var u=!0;return"change"===n&&(u=!1!==t.Ab(l,11).onChange(e.target.value)&&u),"blur"===n&&(u=!1!==t.Ab(l,11).onTouched()&&u),u},null,null)),t.pb(11,16384,null,0,R.v,[t.E,t.k],null,null),t.Fb(1024,null,R.o,function(l){return[l]},[R.v]),t.pb(13,540672,null,0,R.i,[[8,null],[8,null],[6,R.o],[2,R.D]],{form:[0,"form"]},null),t.Fb(2048,null,R.p,null,[R.i]),t.pb(15,16384,null,0,R.q,[[4,R.p]],null,null),(l()(),t.qb(16,0,null,null,3,"option",[["value","full"]],null,null,null,null,null)),t.pb(17,147456,null,0,R.t,[t.k,t.E,[2,R.v]],{value:[0,"value"]},null),t.pb(18,147456,null,0,R.E,[t.k,t.E,[8,null]],{value:[0,"value"]},null),(l()(),t.Ib(-1,null,["Full"])),(l()(),t.qb(20,0,null,null,3,"option",[["value","spectate"]],null,null,null,null,null)),t.pb(21,147456,null,0,R.t,[t.k,t.E,[2,R.v]],{value:[0,"value"]},null),t.pb(22,147456,null,0,R.E,[t.k,t.E,[8,null]],{value:[0,"value"]},null),(l()(),t.Ib(-1,null,["Spectate"]))],function(l,n){var e=n.component;l(n,1,0,e.sortGroup);var t=l(n,7,0,e.reorderable);l(n,6,0,"btn",t),l(n,13,0,e.viewModeControl),l(n,17,0,"full"),l(n,18,0,"full"),l(n,21,0,"spectate"),l(n,22,0,"spectate")},function(l,n){l(n,0,0,t.Ab(n,3).ngClassUntouched,t.Ab(n,3).ngClassTouched,t.Ab(n,3).ngClassPristine,t.Ab(n,3).ngClassDirty,t.Ab(n,3).ngClassValid,t.Ab(n,3).ngClassInvalid,t.Ab(n,3).ngClassPending),l(n,10,0,t.Ab(n,15).ngClassUntouched,t.Ab(n,15).ngClassTouched,t.Ab(n,15).ngClassPristine,t.Ab(n,15).ngClassDirty,t.Ab(n,15).ngClassValid,t.Ab(n,15).ngClassInvalid,t.Ab(n,15).ngClassPending)})}var U=e("ny3C"),V=e("ygrl"),z=e("hU6i"),H=e("lD+H"),X=e("tHUJ"),J=e("Pqmk"),N=e("DwCd"),Y=function(l,n,e,t){return new(e||(e=Promise))(function(u,i){function r(l){try{a(t.next(l))}catch(n){i(n)}}function o(l){try{a(t.throw(l))}catch(n){i(n)}}function a(l){l.done?u(l.value):new e(function(n){n(l.value)}).then(r,o)}a((t=t.apply(l,n||[])).next())})},Q=function(l,n){var e,t,u,i,r={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(i){return function(o){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;r;)try{if(e=1,t&&(u=2&i[0]?t.return:i[0]?t.throw||((u=t.return)&&u.call(t),0):t.next)&&!(u=u.call(t,i[1])).done)return u;switch(t=0,u&&(i=[2&i[0],u.value]),i[0]){case 0:case 1:u=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,t=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(u=(u=r.trys).length>0&&u[u.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!u||i[1]>u[0]&&i[1]<u[3])){r.label=i[1];break}if(6===i[0]&&r.label<u[1]){r.label=u[1],u=i;break}if(u&&r.label<u[2]){r.label=u[2],r.ops.push(i);break}u[2]&&r.ops.pop(),r.trys.pop();continue}i=n.call(l,r)}catch(o){i=[6,o],t=0}finally{e=u=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}},W=function(){function l(l,n,e){this.campaignService=l,this.overviewService=n,this.conceptService=e,this.loading=!1}return l.prototype.ngOnInit=function(){var l=this;this.labelControl=new R.h(null),this.overviewService.loadOverviewState(),this.loadConcepts=function(n){return Y(l,void 0,void 0,function(){return Q(this,function(l){switch(l.label){case 0:return this._addingConceptType?[4,this.conceptService.getConcepts(this._addingConceptType.id,6,0,n)]:[2];case 1:return[2,l.sent().concepts.map(function(l){return{displayHtml:l.name,value:l}})]}})})}},l.prototype.trackEntityElement=function(l,n){return n.id},l.prototype.entityDropped=function(l){this.overviewService.swapEntities(l.previousIndex,l.currentIndex)},l.prototype.editLabel=function(l){return Y(this,void 0,void 0,function(){var n;return Q(this,function(e){switch(e.label){case 0:return this.labels&&this.labels[l.id]&&this.labelControl.setValue(this.labels[l.id]),[4,this._labelModal.open()];case 1:return n=e.sent(),this.labelControl.setValue(null),"clear-label"===n?(this.overviewService.setLabel(l,null),[2]):(n&&this.overviewService.setLabel(l,n),[2])}})})},l.prototype.addConceptTypeToEntity=function(l,n){return Y(this,void 0,void 0,function(){var e;return Q(this,function(t){switch(t.label){case 0:return this._addingConceptType=l,[4,this._conceptSelector.openSelector()];case 1:return e=t.sent(),this._addingConceptType=null,e&&e.value&&this.overviewService.addConceptEntity(n,e.value,l),[2]}})})},l.prototype.getConceptsForEntity=function(l){return this.state?this.state.entityConcepts[l]:null},Object.defineProperty(l.prototype,"campaign",{get:function(){return this.campaign},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"editable",{get:function(){return this.campaignService.canEdit},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"sortedEntities",{get:function(){return this.overviewService.sortedEntities},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"state",{get:function(){return this.overviewService.state},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"reorderable",{get:function(){return this.overviewService.reorderable},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"labels",{get:function(){return this.state&&this.state.entityLabels},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"labelFieldConfig",{get:function(){return{name:"Label",description:"A label that will show up in the overview screen",type:N.a.STRING,options:{required:!1,maxLength:8}}},enumerable:!0,configurable:!0}),l}(),Z=t.ob({encapsulation:0,styles:[["[_nghost-%COMP%] > .container[_ngcontent-%COMP%]{height:100%}"]],data:{}});function ll(l){return t.Kb(0,[(l()(),t.qb(0,0,null,null,0,"div",[["class","drag-placeholder"]],null,null,null,null,null))],null,null)}function nl(l){return t.Kb(0,[(l()(),t.qb(0,16777216,null,null,9,"div",[["cdkDrag",""],["class","mb-2 cdk-drag"]],[[2,"cdk-drag-disabled",null],[2,"cdk-drag-dragging",null]],null,null,null,null)),t.Fb(6144,null,r.l,null,[r.c]),t.pb(2,4866048,[[3,4]],3,r.c,[t.k,[3,r.b],o.c,t.A,t.P,a.a,r.j,r.a,[2,c.a],r.h,t.h],{disabled:[0,"disabled"]},null),t.Gb(603979776,4,{_handles:1}),t.Gb(335544320,5,{_previewTemplate:0}),t.Gb(335544320,6,{_placeholderTemplate:0}),(l()(),t.hb(0,null,null,1,null,ll)),t.pb(7,16384,[[6,4]],0,r.e,[t.M],null,null),(l()(),t.qb(8,0,null,null,1,"dd-overview-entity",[],null,[[null,"editLabel"],[null,"addConcept"]],function(l,n,e){var t=!0,u=l.component;return"editLabel"===n&&(t=!1!==u.editLabel(l.context.$implicit)&&t),"addConcept"===n&&(t=!1!==u.addConceptTypeToEntity(e,l.context.$implicit)&&t),t},K,A)),t.pb(9,114688,null,0,P,[d.b,h.a,v.b,C],{entity:[0,"entity"],label:[1,"label"],showMoveIcon:[2,"showMoveIcon"],conceptEntities:[3,"conceptEntities"]},{editLabel:"editLabel",addConcept:"addConcept"}),(l()(),t.hb(0,null,null,0))],function(l,n){var e=n.component;l(n,2,0,!e.reorderable),l(n,9,0,n.context.$implicit,e.labels&&e.labels[n.context.$implicit.id],e.reorderable,e.getConceptsForEntity(n.context.$implicit.id))},function(l,n){l(n,0,0,t.Ab(n,2).disabled,t.Ab(n,2)._dragRef.isDragging())})}function el(l){return t.Kb(0,[(l()(),t.qb(0,0,null,null,6,"div",[["class","empty mb-2"]],null,null,null,null,null)),(l()(),t.qb(1,0,null,null,1,"div",[["class","empty-icon"]],null,null,null,null,null)),(l()(),t.qb(2,0,null,null,0,"i",[["class","icon icon-search icon-4x"]],null,null,null,null,null)),(l()(),t.qb(3,0,null,null,1,"p",[["class","empty-title h5"]],null,null,null,null,null)),(l()(),t.Ib(-1,null,["There's nothing here"])),(l()(),t.qb(5,0,null,null,1,"p",[["class","empty-subtitle"]],null,null,null,null,null)),(l()(),t.Ib(-1,null,["Once the campaign gets going this will fill up"]))],null,null)}function tl(l){return t.Kb(0,[(l()(),t.qb(0,0,null,null,1,"dd-overview-toolbar",[],null,null,null,B,$)),t.pb(1,114688,null,0,G,[C],{state:[0,"state"]},null)],function(l,n){l(n,1,0,n.component.state)},null)}function ul(l){return t.Kb(0,[t.Gb(402653184,1,{_labelModal:0}),t.Gb(402653184,2,{_conceptSelector:0}),(l()(),t.qb(2,0,null,null,12,"dd-modal",[["size","small"]],null,null,null,U.b,U.a)),t.pb(3,114688,[[1,4],["labelmodal",4]],0,V.a,[],{size:[0,"size"]},null),(l()(),t.qb(4,0,null,0,1,"h5",[["modal-header",""]],null,null,null,null,null)),(l()(),t.Ib(-1,null,["Edit Label"])),(l()(),t.qb(6,0,null,1,2,"div",[["modal-body",""]],null,null,null,null,null)),(l()(),t.qb(7,0,null,null,1,"dd-dynamic-field",[],null,null,null,z.b,z.a)),t.pb(8,114688,null,0,H.a,[],{control:[0,"control"],config:[1,"config"]},null),(l()(),t.qb(9,0,null,2,5,"div",[["modal-footer",""]],null,null,null,null,null)),(l()(),t.qb(10,0,null,null,2,"button",[["class","btn btn-sm btn-error mr-2"]],null,[[null,"click"]],function(l,n,e){var u=!0;return"click"===n&&(u=!1!==t.Ab(l,3).close("clear-label")&&u),u},null,null)),(l()(),t.qb(11,0,null,null,0,"i",[["class","icon icon-cross"]],null,null,null,null,null)),(l()(),t.Ib(-1,null,[" Clear Label"])),(l()(),t.qb(13,0,null,null,1,"button",[["class","btn btn-sm"]],[[8,"disabled",0]],[[null,"click"]],function(l,n,e){var u=!0,i=l.component;return"click"===n&&(u=!1!==t.Ab(l,3).close(i.labelControl.value)&&u),u},null,null)),(l()(),t.Ib(-1,null,[" Save "])),(l()(),t.qb(15,0,null,null,1,"dd-selector-popup",[],null,null,null,X.b,X.a)),t.pb(16,114688,[[2,4],["conceptselector",4]],0,J.a,[],{searchable:[0,"searchable"],loadSelectItems:[1,"loadSelectItems"]},null),(l()(),t.qb(17,0,null,null,15,"div",[["class","container"]],null,null,null,null,null)),(l()(),t.qb(18,0,null,null,3,"div",[["class","columns"]],null,null,null,null,null)),(l()(),t.qb(19,0,null,null,2,"div",[["class","column"]],null,null,null,null,null)),(l()(),t.qb(20,0,null,null,1,"h3",[],null,null,null,null,null)),(l()(),t.Ib(-1,null,["Overview"])),(l()(),t.qb(22,0,null,null,6,"div",[["cdkDropList",""],["class","cdk-drop-list"]],[[8,"id",0],[2,"cdk-drop-list-disabled",null],[2,"cdk-drop-list-dragging",null],[2,"cdk-drop-list-receiving",null]],[[null,"cdkDropListDropped"]],function(l,n,e){var t=!0,u=l.component;return"cdkDropListDropped"===n&&(t=!1!==u.entityDropped(e)&&t),t},null,null)),t.Fb(6144,null,r.b,null,[r.f]),t.pb(24,1196032,null,1,r.f,[t.k,r.j,t.h,[2,c.a],[3,r.g],[2,o.c],r.h],null,{dropped:"cdkDropListDropped"}),t.Gb(603979776,3,{_draggables:1}),t.Fb(256,null,r.g,void 0,[]),(l()(),t.hb(16777216,null,null,1,null,nl)),t.pb(28,278528,null,0,o.j,[t.P,t.M,t.t],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null),(l()(),t.hb(16777216,null,null,1,null,el)),t.pb(30,16384,null,0,o.k,[t.P,t.M],{ngIf:[0,"ngIf"]},null),(l()(),t.hb(16777216,null,null,1,null,tl)),t.pb(32,16384,null,0,o.k,[t.P,t.M],{ngIf:[0,"ngIf"]},null)],function(l,n){var e=n.component;l(n,3,0,"small"),l(n,8,0,e.labelControl,e.labelFieldConfig),l(n,16,0,!0,e.loadConcepts),l(n,28,0,e.sortedEntities,e.trackEntityElement),l(n,30,0,0===e.sortedEntities.length),l(n,32,0,e.sortedEntities.length>0&&e.editable)},function(l,n){l(n,13,0,n.component.labelControl.invalid),l(n,22,0,t.Ab(n,24).id,t.Ab(n,24).disabled,t.Ab(n,24)._dropListRef.isDragging(),t.Ab(n,24)._dropListRef.isReceiving())})}function il(l){return t.Kb(0,[(l()(),t.qb(0,0,null,null,1,"dd-overview",[],null,null,null,ul,Z)),t.pb(1,114688,null,0,W,[d.b,C,w.a],null,null)],function(l,n){l(n,1,0)},null)}var rl=t.mb("dd-overview",W,il,{},{},[]),ol={suggestable:!0},al=function(){return function(){}}(),cl=e("EA6F"),sl=e("wC5x");e.d(n,"OverviewModuleNgFactory",function(){return bl});var bl=t.nb(u,[],function(l){return t.xb([t.yb(512,t.j,t.cb,[[8,[i.a,rl]],[3,t.j],t.y]),t.yb(4608,o.m,o.l,[t.v,[2,o.w]]),t.yb(4608,R.g,R.g,[]),t.yb(4608,R.C,R.C,[]),t.yb(4608,r.h,r.h,[o.c,t.A,a.a,r.j]),t.yb(1073742336,o.b,o.b,[]),t.yb(1073742336,s.o,s.o,[[2,s.u],[2,s.l]]),t.yb(1073742336,al,al,[]),t.yb(1073742336,R.y,R.y,[]),t.yb(1073742336,R.u,R.u,[]),t.yb(1073742336,R.n,R.n,[]),t.yb(1073742336,r.i,r.i,[]),t.yb(1073742336,cl.a,cl.a,[]),t.yb(1073742336,sl.a,sl.a,[]),t.yb(1073742336,u,u,[]),t.yb(1024,s.j,function(){return[[{path:"",component:W,data:ol}]]},[])])})}}]);